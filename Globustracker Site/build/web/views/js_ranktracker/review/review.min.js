var addMainDataInSIComp,addTabsForSIComp,adjustLegendSymbolRadius,bindClicksOnTasks,bindEventOnSettingsBox,calculTopBars,calculTopPriorities,checkDirectTaskAnchor,checkEmptyModule,checkWooChart,checkWooLatestChanges,cleanWooCharts,closeAllInlineModal,competizeAll,competizeBacklinksCounter,competizeSocialImpact,competizeTopRankingKeywords,defaults,extractDataProviders,fetchLatestChanges,fetchPjCriteriumData,fetchProviderData,finalizeWooCounter,formatMomentJs,generators,getColorCode,getCountryCode,getCriteriumId,getSettingsDataFor,getSharingUrl,getURLParameter,handleFallback,hideAllConfirmationForms,initCompTabs,initDashboardFooter,initLatestChanges,initTopBarTrial,initWooCounter,initializeAdvice,loadMustachesFiles,loadProjectTasks,moduleMapping,mustachePromise,prettifyNumbersInAdvReview,prettifyNumbersInReview,prettifyUrlInReviewLists,putSIDataInArray,renderGenderAgeChart,renderGeoChart,renderLineChart,renderProject,renderProjectCriteria,renderProjectTasks,renderSettingBox,renderTabs,renderUptime,resetSharingBox,resetWooCounter,resolveDataUrl,setDataForCrit,setInsideRank,templateData,toggleInlineModal,truncateFormatter,unique,updateAllWooHighChartsHeight,updateTaskCompletionBar,updateWooCounter,updateWooHighCharts,usePiecon,wooGeoCharts,wooHighCharts,wooMap,wooMaps,_checkWooChart;$.fn.extend({externalLinks:function(){return this.each(function(){return $(this).find("a.js-external-link").each(function(){var e,t,n;return e=$(this),e.attr("href","#"),e.removeClass("js-external-link"),n="hover focus click",t=function(){return e.attr("href",e.attr("data-href")),e.removeAttr("data-href"),e.off(n,t)},e.on(n,t)})})}}),$.fn.extend({truncate:function(){return this.each(function(){return $(this).find(".js-truncated-content").each(function(){var e,t,n,a;return t=$(this),n=t.height()||0,a=t.find("> div").height()||0,e=t.next(".js-truncate-btns"),a>n?e.show():e.hide()})})}}),checkWooLatestChanges=function(e){var t;return t=new Date,e.find(".lc-moment").each(function(){var e,t,n,a,r;return a=$(this),r=a.text(),n=void 0,"today"===r.toLowerCase()?a.text(moment().format(moment.calendar.sameDay)):r.match("week")?(t=r.split("#"),e="",n=moment(t[1],"YYYY-MM-DD"),e+=n.format("MMM D")+" - ",n=moment(t[2],"YYYY-MM-DD"),e+=n.format("MMM D"),a.text(e)):10===r.length?(n=moment(r,"YYYY-MM-DD"),a.text(n.format("MMM D"))):7===r.length?(n=moment(r,"YYYY-MM"),a.hasClass("show-year")?a.text(n.format("MMMM YYYY")):a.text(n.format("MMMM"))):void 0}),e.find(".lc.over-max").length>0&&e.find(".show-lc.hidden").removeClass("hidden"),e.find(".lc.is-link").on("click",function(){return scrollToObj($(this).data("href"))})},truncateFormatter=function(){var e;return e=30,this.name.length>e?""+this.name.slice(0,e)+"…":this.name},window.buildChartConfig=function(e,t){return $.extend(!0,{},defaults[e],t)},defaults={line:{chart:{defaultSeriesType:"spline",height:250,marginRight:0,marginLeft:36,marginBottom:80},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%e %b"},lineColor:"#f1f1f1",tickWidth:0,minPadding:.05,maxPadding:.05},yAxis:{gridLineWidth:0,lineColor:null,lineWidth:0,minPadding:.05,maxPadding:.1,minRange:.01,endOnTick:!1,min:0,max:null,allowDecimals:!1,labels:{formatter:function(){var e,t;return t=this.value,e=0>t?"-":"",t=Math.abs(t),t>=1e3&&1e6>t?(t=Math.floor(t/100)/10,t+="k"):t>=1e6&&(t=Math.floor(t/1e5)/10,t+="M"),e+t}}},legend:{align:"left",verticalAlign:"bottom",margin:0,x:-18,labelFormatter:truncateFormatter},tooltip:{enabled:!0},plotOptions:{spline:{groupPadding:0,borderColor:null,stickyTracking:!1,marker:{enabled:!0,symbol:"circle",radius:2,states:{hover:{radius:3}}},shadow:!1,connectNulls:!0}}},"gender-age-chart":{chart:{type:"column",height:250,marginBottom:130},xAxis:{categories:["13-17","18-24","25-34","35-44","45-54","55-64","65+"],lineWidth:0,lineColor:"#f1f1f1",tickWidth:0,minPadding:.05,maxPadding:.05},yAxis:{lineColor:null,lineWidth:0,minPadding:.05,maxPadding:.1,endOnTick:!1,labels:{formatter:function(){return Math.abs(this.value)}}},legend:{align:"left",verticalAlign:"bottom",floating:!0,margin:0,labelFormatter:truncateFormatter},tooltip:{enabled:!0,formatter:function(){var e;return e="<b>"+this.x+"</b>",$.each(this.points,function(t,n){return e+="<br/>"+n.series.name+" : "+Math.abs(n.y)}),e},shared:!0},plotOptions:{column:{stacking:"normal",groupPadding:.15,pointWidth:22,borderColor:null,shadow:!1}}},column:{chart:{type:"column",height:250,marginRight:0,marginLeft:36,marginBottom:20},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%e %b"},lineColor:"#f1f1f1",tickWidth:0,minPadding:.05,maxPadding:.05},yAxis:{gridLineWidth:0,lineColor:null,lineWidth:0,minPadding:.05,maxPadding:.1,endOnTick:!1,labels:{formatter:function(){var e,t,n,a;return a=.01>=this.value?0:this.value,e=void 0,t=void 0,n=void 0,e=Math.floor(a/60),t=Math.floor(a)%60,n=Math.floor(60*(a-60*e-t)),e>0?e+"h":t>0?t+"m":n>0?n+"s":a}}},legend:{align:"left",verticalAlign:"top",margin:0,floating:!0,x:36,labelFormatter:truncateFormatter},tooltip:{enabled:!0,formatter:function(){var e,t,n,a,r;return r=.01>=this.y?0:this.y,e=void 0,n=void 0,a=void 0,e=Math.floor(r/60),n=Math.floor(r)%60,a=Math.floor(60*(r-60*e-n)),t="",t+=e>0?" "+e+"h":"",t+=n>0?" "+n+"m":"",t+=a>0?" "+a+"s":"",0===t.length&&(t="0"),""+Highcharts.dateFormat("%e. %b %Y",this.x)+" : "+t}},plotOptions:{column:{borderWidth:0,shadow:!1,color:"#C4392F"}}}},adjustLegendSymbolRadius=function(e,t){return $(e.series).each(function(e,n){var a,r,i;return a=n.legendSymbol.attr("width")/2,r=n.legendSymbol.attr("x"),i=n.legendSymbol.attr("y"),n.legendSymbol.attr("width",2*t),n.legendSymbol.attr("height",2*t),n.legendSymbol.attr("x",r+a-t),n.legendSymbol.attr("y",i+a-t)})},renderLineChart=function(e,t){var n,a;return a=window.buildChartConfig("line",{chart:{renderTo:e.find(".line-chart")[0]},series:t.series}),n=new Highcharts.Chart(a),adjustLegendSymbolRadius(n,5)},renderGenderAgeChart=function(e,t){var n,a;return a=window.buildChartConfig("gender-age-chart",{chart:{renderTo:e.find(".gender-age-chart")[0]},series:t.series}),n=new Highcharts.Chart(a)},renderGeoChart=function(e,t){var n,a,r,i,o,s,l,c,d,u;for(c=[],$.each(t,function(e,t){return c.push(t)}),s=c.length>0?Math.max.apply(Math,c):100,l=c.length>0?Math.min.apply(Math,c):0,i=function(e){return 100*(e-l)/(s-l)},n=e.find(".pj-woomap"),n.vectorMap({map:"world_en",backgroundColor:"#fff",color:"#E4E4E4",scaleColors:[mapColors[0],mapColors[100]],values:t,borderColor:"#fff",borderWidth:1,borderOpacity:1,hoverColor:"#294c6e",selectedColor:"#294c6e",enableZoom:!1}),n.bind("regionMouseOver.jqvmap",function(e){return e.preventDefault()}),n.height(n.height()+40+"px"),a=e.find(".scale"),a.find(".scale-start").text(Math.floor(l)),a.find(".scale-end").text(Math.floor(s)),r=a.find(".scale-items"),u=[],o=d=0;100>=d;o=d+=10)u.push($("<span>").addClass("scale-item").css("background",mapColors[o]).appendTo(r));return u},renderUptime=function(e,t){return $.each(t,function(t,n){var a,r,i,o;return n.hasDownTime?(i=e.find(".uptime-container")[0],a=e.find(".downtime-container")[0],r=window.buildChartConfig("column",{chart:{renderTo:a},series:n.chartData.downTime,legend:{enabled:!1},yAxis:{min:0,max:1440}}),o=window.buildChartConfig("line",{chart:{renderTo:i,height:250,marginBottom:20},series:n.chartData.upTime,legend:{enabled:!1},yAxis:{min:0,max:105}}),new Highcharts.Chart(r),new Highcharts.Chart(o)):void 0})},renderTabs=function(e,t,n){var a,r;return $.each(t.tabs,function(e,t){var a;return a=$("#"+t.id),window.renderProjectParts(a,t,n),!0}),a=1,e.find(".section-container-tabs li").each(function(e,t){return $(t).is(".not-tab")?(a+=1,!0):!1}),r=e.find(".section-container-tabs li:nth-child("+a+"), .tab-pane:nth-child("+a+")"),r.addClass("active")},generators={"gender-age-chart":renderGenderAgeChart,"line-chart":renderLineChart,"geo-chart":renderGeoChart,uptime:renderUptime,tabbed:renderTabs},window.renderProjectParts=function(e,t,n){var a,r,i,o,s,l,c,d,u,p;if(t.parts){for(u=t.parts,p=[],c=0,d=u.length;d>c;c++)s=u[c],o=Mustache.render(n,s),a=$(o),e.append(a),p.push(function(){var e;e=[];for(i in generators)r=generators[i],l=s[i],l?e.push(r(a,l,n)):e.push(void 0);return e}());return p}},moduleMapping={},$(".module").each(function(){var e;return e=$(this),e.find(".criterium").each(function(){var t;return t=$(this),moduleMapping[t.attr("id")]=e.attr("id")})}),loadProjectTasks=function(e){var t;return t="/"+wooLang+"/projects/"+e+"/tasks",$.ajax({type:"GET",cache:!1,url:t,dataType:"json",success:renderProjectTasks})},renderProjectTasks=function(e){var t,n,a,r,i;e.done&&(window.tasksDoneArray=e.done),i=e.sections;for(r in i)a=i[r],n=Mustache.render(mustacheTemplates.projectTasks,a),t=$(".tasks-for-"+r),""!==n?(t.removeClass("hidden"),t.find(".project-tasks-list").append(n),a.tasksList.length>3?t.find(".show-links").removeClass("hidden"):t.find(".show-links").remove()):t.remove();return updateTaskCompletionBar(e.stats),bindClicksOnTasks(),checkDirectTaskAnchor(),$(window).trigger("projectTasksLoaded")},updateTaskCompletionBar=function(e){var t,n;return null!=e?(n=e.percent,t=$("#dashboard-tasks-bars #blue-bar-counter").find(".percent"),t.css({width:n+"%"})):void 0},bindClicksOnTasks=function(){return $("#lc-container, .task-container").on("click",".task-quicktip",function(e){var t,n;return e.preventDefault(),n=$(this),t=n.attr("href"),0===$(t).length&&(t="#"+moduleMapping[t.substr(1)]),window.location.replace(t)}),$(".task-container>.task-header").on("click",function(e){var t,n,a;return e.preventDefault(),t=$(this),n=t.parent(".task-container"),a=n.siblings(),a.removeClass("open"),n.toggleClass("open")}),$(".task-container:not(.proccessing) .checker").on("click",function(e){var t,n,a,r;return e.preventDefault(),n=$(this),a=n.parents(".task-container").addClass("proccessing"),r=a.attr("id").replace("project-task-",""),t="/"+wooLang+"/projects/"+projectTaskUrl+"/tasks/"+r+"/check",$.ajax({type:"POST",cache:!1,data:"checked=1",url:t,context:a,dataType:"json",success:function(e){return n=$(this),e&&e.checked?(n.addClass("removed"),n.delay(1500).fadeOut(400,function(){return $(this).remove()})):n.removeClass("proccessing")},error:function(){return n.removeClass("proccessing")}})}),$("#lc-inner .lc.lc-task-done").live("click",function(e){var t,n,a,r;return e.preventDefault(),n=$(this),r=n.data("taskid"),"undefined"!=typeof tasksDoneArray&&null!==tasksDoneArray&&r>0&&null!=tasksDoneArray[r]?(tasksDoneArray[r].readOnly=!0,t=n.next(".task-container"),t.length>0?t.remove():(a=Mustache.render(mustacheTemplates.projectTasks,{tasksList:[tasksDoneArray[r]]}),n.after(a),n.next(".task-container").addClass("checked open"))):void 0})},checkDirectTaskAnchor=function(){var e,t;return e=window.location.hash,e?(t=$(e),t.is(":visible")||t.parent(".over-max-list").next(".show-links").find(".show-more").trigger("click"),t.find(">.task-header").trigger("click"),scrollToObj(e)):void 0},usePiecon=!0,initWooCounter=function(){var e,t,n,a;if(!(0>=$("#holder").length))return e=Raphael("holder",widthHeight+1,widthHeight+1),t={stroke:"#fff","stroke-width":strokeSize},n=$("#score-value"),e.customAttributes.arc=function(e,t){var a,r,i,o,s,l,c,d;return s=void 0,r=360/t*e,a=(90-r)*Math.PI/180,c=widthHeight/2+radius*Math.cos(a),d=widthHeight/2-radius*Math.sin(a),o="hsb(".concat(.0444+.2361*(e/t),", 1 , .75)"),i=""+Math.round(e)/10,l=i.split("."),l[1]?n.html(l[0]+"<span class='decimal'>."+l[1]+"</span>"):n.html(l[0]),s=t===e?[["M",widthHeight/2,widthHeight/2-radius],["A",radius,radius,0,1,1,widthHeight/2,widthHeight/2-radius]]:[["M",widthHeight/2,widthHeight/2-radius],["A",radius,radius,0,+(r>180),1,c,d]],{path:s,stroke:o}},a=n.text(),window.wooCounter=a?e.path().attr(t).attr({arc:[10*a,1e3,radius]}).translate(1,0):e.path().attr(t).attr({arc:[1e3,1e3,radius]}).translate(1,0),usePiecon?(Piecon.setOptions({color:"#315D86",background:"#ddd",shadow:"#fff",fallback:!1}),Piecon.setProgress(Math.round(a))):void 0},setInsideRank=function(e){var t,n;return isInsideReview?(t="e",e>=70?t="aplus":e>=60?t="a":e>=50?t="b":e>=40?t="c":e>=30&&(t="d"),n=t.replace("plus",'<span class="plus">+</span>'),$("#holder").addClass("rank-"+t),$("#rank-value").html(n)):void 0},resetWooCounter=function(){var e;return e=0},updateWooCounter=function(e){var t;if(!(0>=$("#holder").length))return!isInsideReview&&(currentScoring+=10*e,wooCounter.animate({arc:[currentScoring,1e3,radius]},1e3,"<>"),t=Math.round(currentScoring)/10,usePiecon)?Piecon.setProgress(t):void 0},finalizeWooCounter=function(e){return 0>=$("#holder").length?void 0:(wooCounter.animate({arc:[e,1e3,radius]},1e3,"<>"),usePiecon?Piecon.setProgress(Math.round(e/10)):void 0)},checkEmptyModule=function(e){return null==e&&(e="#right-panel:not(.light-report)"),$(e).find("#report-content>.module.hidden, #report-content>.module.module-empty").remove(),$("#report-content>.module:not(.hidden)").each(function(){var e,t;return e=$(this),t=e.find(".teasing-box, .criterium:not(.hidden)"),0===t.length?($("#left-nav").find("nav>a[href=#"+e.attr("id")+"]").remove(),e.remove()):void 0}),$("#left-nav .nav-section .section-title.inpage-link").each(function(){var e,t;return e=$(this),t=e.siblings(),0===t.length?($(e.attr("href")).remove(),e.remove()):void 0}),$("#left-nav nav>a:not(.hidden)").each(function(){var e,t;return e=$(this),t=$(e.attr("href")),0===t.length?e.remove():void 0}),$("#left-nav .nav-section").each(function(){var e,t;return t=$(this),e=t.find("a"),0===e.length?t.remove():void 0})},getURLParameter=function(e){var t,n;return n=decodeURI(RegExp(e+"="+"(.+?)(&|$)").exec(location.search)),n||(n=","),t=n.split(","),t[1]},putSIDataInArray=function(e,t,n){var a,r,i;return i=0,a={},r={url:e.find("h4").text(),id:n},e.find(".part.text p").each(function(){var e,t,n;return t=$(this),n=parseInt(t.find(".big-right-aligned-content").text()),e=t.find(".big-right-aligned").text(),0/0!==n&&""!==e?(a[e]=n,i+=n):void 0}),r.medias=a,r.total=i,t[r.url]=r,t},addMainDataInSIComp=function(e,t){var n,a,r,i,o,s,l;return o=e.find("h4").text(),n=t[currentWebsite],a=t[o],i=18,null!=n&&null!=a?(s=i>n.url.length?n.url:n.url.substr(0,i-3)+"...",l=i>a.url.length?a.url:a.url.substr(0,i-3)+"...",r=$('<table class="social-media-compare comp-'+a.id+'"><thead><tr><th></th><th><span class="color"></span>'+s+'</th><th><span class="color"></span>'+l+"</th></tr></thead><tbody></tbody></table>"),e.find("p span.big-right-aligned").each(function(){var e,t,i,o,s,l,c;return c=$(this),l=c.text(),e=parseInt(n.medias[l]),i=parseInt(a.medias[l]),t=isNaN(e)?"<td>?</td>":e>i?'<td class="bold">'+e+"</td>":"<td>"+e+"</td>",o=isNaN(i)?"<td>?</td>":i>e?'<td class="bold">'+i+"</td>":"<td>"+i+"</td>",s="<tr><td>"+$("<div>").append(c.clone()).html()+"</td>"+t+o+"</tr>",r.find("tbody").append(s)}),e.addClass("social-media-tab-content tab-content full-width").html(r)):void 0},addTabsForSIComp=function(e,t,n){var a,r,i,o,s,l,c;s=$('<div class="social-media-tabs comp-tabs"></div>'),o=[27,20,14],i=o[n-2];for(l in t)a=t[l],c=a.url,r='<span class="color"></span>'+c,l===currentWebsite?s.prepend('<span class="not-tab" title="'+c+'">'+r+"</span>"):s.append('<a class="tab no-advice-target" title="'+c+'">'+r+"</a>");return e.after(s)},initCompTabs=function(){return $(".comp-tabs:not(.binded)").each(function(){var e,t,n;return t=$(this).addClass("binded"),e=t.find("a.tab"),n=t.nextAll(".tab-content"),$(e[0]).addClass("active"),$(n[0]).addClass("active"),e.on("click",function(t){var a,r;return t.preventDefault(),r=$(this),r.hasClass("active")?void 0:(e.removeClass("active"),r.addClass("active"),a=e.index(r),n.removeClass("active"),$(n[a]).addClass("active"))})})},competizeSocialImpact=function(){var e,t,n,a,r,i,o,s,l,c,d,u,p;if(p=$("#criterium-social_impact.criterium-have-comp:not(.is-competized):not(.criterium-loading)"),t=p.find(">div.criterium-content"),e=p.find(">div.competitor-content"),a={},1===p.length&&1===t.length&&e.length>0){p.addClass("is-competized"),a=putSIDataInArray(t,a,0),o=0,e.each(function(){var e;return e=$(this),o++,a=putSIDataInArray(e,a,o)}),r=Object.keys(a).length,e.each(function(){var e;return e=$(this),addMainDataInSIComp(e,a,r)}),addTabsForSIComp(t,a,r),s=0;for(u in a)d=a[u].total,d>s&&(s=d);s*=1.05,c="";for(u in a)n=a[u],l=parseInt(100*(n.total/s)),3>l&&(l=3),i={graph_progressbar:{htmlclass:33>l?"low-percent":!1,percent:l,title:n.url,value:n.total}},c+=Mustache.render(mustacheTemplates.parts,i);return t.addClass("full-width").html(c)}},competizeTopRankingKeywords=function(){var e,t,n;return n=$("#criterium-top_ranking_keywords.criterium-have-comp:not(.is-competized):not(.criterium-loading)"),1===n.length?(n.addClass("is-competized"),e=n.find(">div.criterium-content, >div.competitor-content"),t=$('<div class="top-keywords-tabs comp-tabs"></div>'),e.each(function(){var e,n,a;return e=$(this),n=e.find("h4"),a=n.text(),t.append('<a class="tab no-advice-target" title="'+a+'"><span class="color"></span>'+a+"</a>"),e.addClass("top-keywords-tab-content tab-content full-width"),n.remove()}),n.find(">div.criterium-content").before(t)):void 0},competizeBacklinksCounter=function(){var e,t,n;return n=$("#criterium-backlinks_counter.criterium-have-comp:not(.is-competized):not(.criterium-loading)"),1===n.length?(n.addClass("is-competized"),e=n.find(">div.criterium-content, >div.competitor-content"),t=0,e.each(function(){var e;return e=parseInt($(this).find(".progressbar .bar .value").data("absValue")),e>t?t=e:void 0}),t*=1.05,e.each(function(){var e,n,a,r;return a=$(this),n=a.find(".progressbar"),r=parseInt(n.find(".bar .value").data("absValue")),e=parseInt(100*(r/t)),n.find(".colored-bar").css("width",e+"%"),33>e?n.addClass("low-percent"):void 0})):void 0},competizeAll=function(e){return null==e&&(e=!1),e||competizeSocialImpact(),e||competizeTopRankingKeywords(),competizeBacklinksCounter(),e?void 0:initCompTabs()},toggleInlineModal=function(e){var t,n,a;return e.preventDefault(),t=$(this),n=t.parent(),a=$("html:not(.bound-imc)"),n.siblings().removeClass("open"),n.toggleClass("open"),$("#dashboard-footer .item.open").length>0?a.addClass("bound-imc").on("click",closeAllInlineModal):void 0},closeAllInlineModal=function(e){var t;return t=$(e.target),!t.hasClass(".inline-modal")&&!t.hasClass("inline-modal-opener")&&!t.parents(".inline-modal").length>0?($("#dashboard-footer .item.open").removeClass("open"),$(this).removeClass("bound-imc").off("click")):void 0},initDashboardFooter=function(){return $(".inline-modal-opener").on("click",toggleInlineModal)},checkWooChart=function(e){var t,n;return cleanWooCharts(),e?n=".criterium-competitor-container .chartify-me":$("body").hasClass("review")||$("body").hasClass("extension")||$("body").hasClass("mobreview")||$("body").hasClass("pdf")?(t=!0,n=".criterium-content .chartify-me"):n=".active .active>.chartify-me,      .active .active tr td>.chartify-me,      #keywords-table .chartify-me,      .graphics-container>.chartify-me,      .ga-data-table .chartify-me,      .graphics-container .tab-pane.active>.chartify-me,      .debug-chart-container .chartify-me",$(n).each(function(){return _checkWooChart($(this))})},_checkWooChart=function(e){var t,n,a,r,i,o,s,l,c,d,u,p,h,f,m,v,g,b;if(o=[],r=0,i="unknow",t="generate-chart-id-"+chartsId,n=null,a=null,f=99999999,p=0,e.parents("#criterium-top_ranking_keywords").length>0)return e.remove(),void 0;if(chartsId++,e.attr("id",t).removeClass("chartify-me"),e.hasClass("pie-chart-container")||e.hasClass("big-pie-chart-container")||e.hasClass("bar-chart-container")||e.hasClass("line-chart-container")||e.hasClass("trend-chart-container")||e.hasClass("revert-trend-chart-container")||e.hasClass("littletrend-chart-container")||e.hasClass("revert-littletrend-chart-container")||e.hasClass("comparative-comp-chart-container")||e.hasClass("nbar-comp-chart-container")||e.hasClass("bar-comp-chart-container")||e.hasClass("genderage-chart-container")||e.hasClass("column-chart-container"))e.find(".value").each(function(){var e,t,n,i,s;return s=$(this),t=s.attr("title"),n=s.attr("stack"),i=!1,e=[],s.find("li").each(function(){var t,n,o,s,l,c,d;return l=$(this),c="null"===l.text()?null:parseFloat(l.text()),o=l.attr("class"),s=!1,i=i?i:c,null==a&&(0>c?a=!1:10>c?a=0:null!=c&&(f>c&&(f=c),c>p&&(p=c))),void 0!==o&&o.match("date-")&&(o=o.replace("date-",""),d=o.slice(0,4),n=o.slice(4,6),t=8===o.length?o.slice(6,8):0,s=Date.UTC(d,n-1,t)),s?e.push([s,c]):e.push(c),r+=null!=c?c:0}),s.hasClass("stacked")?o.push({name:t,data:e,stack:n}):o.push({name:t,data:e,y:i})}),n=e.find(".max").text(),null==a&&(a=p/f>21?0:!1);else if(e.hasClass("geo-chart-container"))m=parseInt(e.find(".nbr-rows").text()),u=e.find("tr:first-child th").first().text(),d=e.find("tr:nth-child(2) th").first().text(),i="world",r=m,o=new google.visualization.DataTable,o.addRows(m),o.addColumn("string",u),o.addColumn("number",d),e.find("table").each(function(){var e;return e=$(this),o.setValue(parseInt(e.find("tr:first-child td:nth-child(2)").text()),parseInt(e.find("tr:first-child td:nth-child(3)").text()),e.find("tr:first-child td:nth-child(4)").text()),o.setValue(parseInt(e.find("tr:nth-child(2) td:nth-child(2)").text()),parseInt(e.find("tr:nth-child(2) td:nth-child(3)").text()),parseFloat(e.find("tr:nth-child(2) td:nth-child(4)").text()))});else{if(!e.hasClass("absolute-geo-chart-container"))return e.remove(),void 0;m=parseInt(e.find(".nbr-rows").text()),u=e.find("tr:first-child th").first().text(),d=e.find("tr:nth-child(2) th").first().text(),i=e.find(".region").text(),r=m,o=new google.visualization.DataTable,o.addRows(m),o.addColumn("string",u),o.addColumn("number",d),s=0,e.find("table").each(function(){var e;return e=$(this),o.setValue(s,0,e.find("tr td.name").text()),o.setValue(s,1,parseInt(e.find("tr td.val").text())),s++})}if(chartsData[chartsId]=o,e.hasClass("pie-chart-container"))i="pie",n=r;else if(e.hasClass("big-pie-chart-container"))i="bpie",n=r;else if(e.hasClass("bar-chart-container"))i="bar";else if(e.hasClass("line-chart-container"))i="spline";else if(e.hasClass("trend-chart-container"))i="trend";else if(e.hasClass("genderage-chart-container"))i="genderage";else if(e.hasClass("revert-trend-chart-container")){for(s in o){o[s].y=1e3/o[s].y;for(c in o[s].data)null!=o[s].data[c]&&(o[s].data[c]=1e3/o[s].data[c])}i="trend"}else if(e.hasClass("littletrend-chart-container"))i="ltrend";else if(e.hasClass("revert-littletrend-chart-container")){for(s in o){o[s].y=1e3/o[s].y;for(c in o[s].data)o[s].data[c]=1e3/o[s].data[c]}i="ltrend"}else{if(e.hasClass("geo-chart-container")||e.hasClass("absolute-geo-chart-container"))return wooGeoCharts(t,o,i,e),void 0;if(e.hasClass("comparative-comp-chart-container"))i="comparative";else if(e.hasClass("bar-comp-chart-container"))i="bar";else if(e.hasClass("nbar-comp-chart-container")){for(s in o)for(c in o[s].data)o[s].data[c]=1/o[s].data[c];i="nbar"}else e.hasClass("column-chart-container")&&(i="column")}if(e.hasClass("comparative-comp-chart-container")||e.hasClass("bar-comp-chart-container")||e.hasClass("nbar-comp-chart-container")){if(b=e.parents(".criterium-competitor-container").find(".main-chart-container"),b.length>0)return updateWooHighCharts("add",b,o),e.remove(),void 0;e.addClass("main-chart-container")}return"pie"!==i||0!==r?(v=e.hasClass("chart-no-decimal"),h=parseFloat(e.attr("data-min-range")),e.hasClass("percent-chart")&&(n=100.9),g=!1,e.hasClass("special-small-chart")&&(g=!0),l=!1,e.closest("#generate-chart-id-0").length>0&&(l=!0),wooHighCharts(i,t,o,n,a,v,h,g,l)):void 0},wooGeoCharts=function(e,t,n,a){var r,i,o,s;return s=490,o=300,a.hasClass("absolute-geo-chart-container")&&(s=680,o=305),r={width:s,height:o,region:n,datalessRegionColor:"#dddddd",colorAxis:{colors:["#999999","#315d86"]},enableRegionInteractivity:!1,legend:{textStyle:{color:"#333333",fontSize:11,fontName:"Open Sans"}}},i=new google.visualization.GeoChart(document.getElementById(e)),i.draw(t,r)},wooHighCharts=function(e,t,n,a,r,i,o,s,l){var c,d,u,p;switch(e){case"pie":return chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,defaultSeriesType:e,height:$("#"+t).width()>500?100:170},colors:null!=l?window.chartColorsPie:window.chartColorsPie2,legend:{align:"center",verticalAlign:"bottom",layout:"vertical",margin:0,floating:!1,labelFormatter:function(){return this.name+"  ( "+this.y+"% )"}},plotOptions:{pie:{allowPointSelect:!1,cursor:"default",shadow:!1,borderColor:null,showInLegend:!0,center:[38,38],size:96,dataLabels:{enabled:!1}}},series:[{type:e,data:n}]});case"bpie":return chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,defaultSeriesType:"pie",height:300},plotOptions:{pie:{shadow:!1,borderColor:null,showInLegend:!0,dataLabels:{enabled:!1}}},series:[{type:"pie",data:n}]});case"nbar":return(!a||""===a||50>a)&&(a=null),c=90+30*n.length,chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,defaultSeriesType:"bar",height:c},xAxis:{title:{text:null},labels:{enabled:!1},minPadding:.05,maxPadding:.05,lineWidth:0,tickWidth:0},yAxis:{title:{text:null},min:0,max:a,opposite:!0,endOnTick:!1,maxPadding:.02,labels:{overflow:"justify",formatter:function(){return 0===this.value?"∞":Math.round(1/this.value)}}},tooltip:{formatter:function(){return this.y>1?""+this.series.name+": "+this.y:""+this.series.name+": "+1/this.y}},legend:{borderWidth:null},plotOptions:{bar:{groupPadding:0,borderColor:null,id:t,shadow:!1,dataLabels:{enabled:!0,color:"#fff",align:"right",x:-12,overflow:"justify",formatter:function(){return this.y>1?this.y:1/this.y+"th"}}}},series:n});case"bar":if(!a||""===a||50>a)a=null;else if(100===a)for(d in n)6>n[d].y&&n.splice(d,1);return c=90+30*n.length,chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,defaultSeriesType:e,height:c,spacingTop:0},xAxis:{title:{text:null},labels:{enabled:!1},minPadding:.05,maxPadding:.05,lineWidth:0,tickWidth:0},yAxis:{title:{text:null},min:0,max:a,opposite:!0,endOnTick:!1,maxPadding:.02,labels:{overflow:"justify",enabled:!1}},legend:{borderWidth:null,reversed:!0},plotOptions:{bar:{groupPadding:0,borderColor:null,id:t,shadow:!1,pointWidth:24,dataLabels:{enabled:!0,color:"#fff",align:"right",x:-10,overflow:"justify",formatter:function(){var e;return e=this.y,100===a&&(e+="%"),e}}}},series:n});case"comparative":return chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,defaultSeriesType:"bar",height:700},colors:window.chartColorsComp,xAxis:{title:{text:null},minPadding:.05,maxPadding:.05,lineWidth:0,tickWidth:0,categories:socialMediaCat,labels:{formatter:function(){switch(this.value){case"fb_likes":return'<img style="max-width:16px" src="/assets/img/css/facebook_l.png" />&nbsp;';case"fb_shares":return'<img style="max-width:16px" src="/assets/img/css/facebook_s.png" />&nbsp;';case"fb_comm":return'<img style="max-width:16px" src="/assets/img/css/facebook_c.png" />&nbsp;';case"tw_bl":return'<img style="max-width:16px" src="/assets/img/css/twitter_b.png" />&nbsp;';case"li_shares":return'<img style="max-width:16px" src="/assets/img/css/linkedin_s.png" />&nbsp;';case"digg":return'<img style="max-width:16px" src="/assets/img/css/digg_e.png" />&nbsp;';case"delicious":return'<img style="max-width:16px" src="/assets/img/css/delicious_b.png" />&nbsp;';case"stumbled_upon":return'<img style="max-width:16px" src="/assets/img/css/stumbleupon.png" />&nbsp;';case"plus_one":return'<img style="max-width:16px" src="/assets/img/css/google_p.png" />&nbsp;';default:return this.value}},useHTML:!0}},yAxis:{title:{text:null},min:0,opposite:!0,endOnTick:!1,maxPadding:.02,max:230,min:-120,gridLineColor:null,plotLines:[{color:"#A0C5E5",width:1,value:0}],labels:{formatter:function(){return 0===this.value?""+window.currentWebsite:""},style:{fontSize:"11px",color:window.baseChartColor}}},legend:{borderWidth:null},plotOptions:{bar:{animation:!1,borderColor:null,id:t,shadow:!1,dataLabels:{enabled:!0,overflow:"justify",formatter:function(){var e;return e=parseInt(this.y),isNaN(e)||0===e?"":200===e?">"+this.y+"%":e>0?"+"+this.y+"%":e+"%"}}}}});case"spline":return r===!1&&(r=null),chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,defaultSeriesType:e,height:s===void 0||s===!1?325:160,marginRight:0,marginLeft:36},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%e %b"},lineColor:null,lineWidth:0,tickWidth:0,minPadding:.05,maxPadding:.05},yAxis:{alternateGridColor:"#f7f7f7",lineColor:null,lineWidth:0,minPadding:.05,maxPadding:.1,minRange:o!==void 0?o:.01,endOnTick:!1,min:r,max:""===a?null:a,allowDecimals:i!==void 0?!i:!1,labels:{formatter:function(){var e;return e=this.value,100.9===a&&(e+="%"),e>=1e3&&1e6>e?(e=Math.floor(e/100)/10,e+="k"):e>=1e6&&(e=Math.floor(e/1e5)/10,e+="M"),e}}},legend:{enabled:n.length>1,align:"left",verticalAlign:"top",margin:0,floating:!0,x:36},tooltip:{enabled:!0},plotOptions:{spline:{groupPadding:0,borderColor:null,stickyTracking:!1,marker:{enabled:!0,symbol:"circle",radius:2,states:{hover:{radius:3}}},shadow:!1,connectNulls:!0}},series:n});case"genderage":return chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,type:"column",height:325},xAxis:{categories:["13-17","18-24","25-34","35-44","45-54","55-64","65+"],lineColor:null,lineWidth:0,tickWidth:0,minPadding:.05,maxPadding:.05},yAxis:{alternateGridColor:"#f7f7f7",lineColor:null,lineWidth:0,minPadding:.05,maxPadding:.1,endOnTick:!1,labels:{formatter:function(){return Math.abs(this.value)}}},legend:{align:"left",verticalAlign:"top",margin:0,floating:!0,x:36},tooltip:{enabled:!0,formatter:function(){var e;return e="<b>"+this.x+"</b>",$.each(this.points,function(t,n){return e+="<br/>"+n.series.name+" : "+Math.abs(n.y)}),e},shared:!0},plotOptions:{column:{stacking:"normal",groupPadding:.2,pointWidth:25,borderColor:null,shadow:!1}},series:n});case"ltrend":case"trend":return u="ltrend"===e,p="ltrend"===e?32:20,chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,defaultSeriesType:"areaspline",height:p,marginRight:0,marginLeft:0,marginTop:0,marginBottom:1},xAxis:{type:"datetime",labels:{enabled:!1},gridLineWidth:0,lineColor:"#999",lineWidth:u?0:1,tickWidth:0,minPadding:.01,maxPadding:.08},yAxis:{labels:{enabled:!1},gridLineWidth:0,lineColor:"#999",lineWidth:u?0:1,minPadding:.01,maxPadding:.08,endOnTick:!1},legend:{enabled:!1},tooltip:{enabled:!1},plotOptions:{areaspline:{groupPadding:0,borderColor:null,id:t,shadow:!1,marker:{enabled:!1},states:{hover:{enabled:!1}},fillOpacity:.2,pointInterval:864e5}},series:n});case"column":return chartsObject[t]=new Highcharts.Chart({chart:{renderTo:t,defaultSeriesType:e,height:s===void 0||s===!1?325:160,marginRight:0,marginLeft:36},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%e %b"},lineColor:null,lineWidth:0,tickWidth:0,minPadding:.05,maxPadding:.05},yAxis:{alternateGridColor:"#f7f7f7",lineColor:null,lineWidth:0,minPadding:.05,maxPadding:.1,minRange:o!==void 0?o:.1,endOnTick:!1,min:r,max:a!==void 0&&""!==a?a:void 0,allowDecimals:i!==void 0?!i:!1,labels:{formatter:function(){var e,t,n,a;return a=.01>=this.value?0:this.value,e=void 0,t=void 0,n=void 0,e=Math.floor(a/60),t=Math.floor(a)%60,n=Math.floor(60*(a-60*e-t)),e>0?e+"h":t>0?t+"m":n>0?n+"s":a}}},legend:{enabled:n.length>1,align:"left",verticalAlign:"top",margin:0,floating:!0,x:36},tooltip:{enabled:!0,formatter:function(){var e,t,n,a,r;return r=.01>=this.y?0:this.y,e=void 0,n=void 0,a=void 0,e=Math.floor(r/60),n=Math.floor(r)%60,a=Math.floor(60*(r-60*e-n)),t="",t+=e>0?" "+e+"h":"",t+=n>0?" "+n+"m":"",t+=a>0?" "+a+"s":"",0===t.length&&(t="0"),""+Highcharts.dateFormat("%e. %b %Y",this.x)+" : "+t}},series:n,plotOptions:{column:{borderWidth:0,shadow:!1,color:"#C4392F"}}});default:console.log("- Unrecongnised chart type -"),console.log("type : "+e),console.log("id : "+t),console.log(n),console.log("----------------------------\n")}},updateWooHighCharts=function(e,t,n){switch(e){case"add":return chartsObject[t.attr("id")].addSeries(n[0])}},updateAllWooHighChartsHeight=function(){var e,t,n,a,r;r=[];for(t in chartsObject)e=chartsObject[t].chartHeight,a=chartsObject[t].chartWidth,n=chartsObject[t].series.length,70+30*n>e?r.push(chartsObject[t].setSize(a,90+30*n,!1)):r.push(void 0);return r},cleanWooCharts=function(){return"0"===$("#criterium-adwords_traffic .criterium-content .pie-chart-container ul:first-child li").text()?$("#criterium-adwords_traffic").remove():void 0
},getCountryCode=function(e){return countries[e]!==void 0?countries[e].toLowerCase():null},getColorCode=function(e,t){return e=10*Math.floor(e*t/10),mapColors[e]},wooMaps=function(){return $(".woomap").each(function(e,t){return wooMap($(t))})},wooMap=function(e){var t,n,a,r,i,o,s,l,c,d,u,p;if(!e.hasClass("yuhuu-mapped")){for(a=e.find(".country-info"),c=[],s=0,r=0;a.length>r;)i=$(a[r]),n=getCountryCode(i.find(".name").html()),l=i.find(".percent").html(),null!=n&&(c[n]=l,s=Math.max(s,l)),++r;t=[];for(o in c)t[o]=getColorCode(c[o],100/s);for(e.predata=c,e.max=s,e.html(""),e.vectorMap({map:"world_en",backgroundColor:"#fff",color:"#E4E4E4",colors:t,borderColor:"#fff",borderWidth:1,borderOpacity:1,hoverColor:"#294c6e",selectedColor:"#294c6e",enableZoom:!1,onLabelShow:function(t,n,a){return l="~ 0",e.predata[a]!==void 0&&(l=e.predata[a]),n.text(n.text()+" : "+l+"%")}}),e.bind("regionMouseOver.jqvmap",function(e){return e.preventDefault()}),e.after("<span class='scale'></span>"),d=e.next(".scale"),d.append("<span class='scale-start'>"+Math.floor(e.max/10)+"</span>"),d.append("<span class='scale-items'></span>"),p=d.find(".scale-items"),r=0;100>=r;)p.append("<span class='scale-item'></span>"),u=p.find(".scale-item:last-child"),u.css("background",mapColors[r]),r+=10;return d.append("<span class='scale-end'>"+Math.ceil(e.max)+"</span>"),e.height(e.height()+40+"px"),e.addClass("yuhuu-mapped")}},calculTopBars=function(){var e,t,n,a,r,i,o;return $("#dashboard-bars").length>0?(r=$("#green-bar-counter"),i=$("#orange-bar-counter"),o=$("#red-bar-counter"),e=$(".criterium.result-1").length,t=$(".criterium.result-2").length,n=$(".criterium.result-3").length,a=e+t+n,r.find(".count").text(e),i.find(".count").text(t),o.find(".count").text(n),a>0?(r.find(".percent").stop().animate({width:100/a*e+"%"},500),i.find(".percent").stop().animate({width:100/a*t+"%"},500),o.find(".percent").stop().animate({width:100/a*n+"%"},500)):$("#green-bar-counter .percent, #orange-bar-counter .percent, #red-bar-counter .percent").css("width","0%")):void 0},calculTopPriorities=function(){var e,t,n,a,r,i,o,s;for(i=[],$(".criterium.result-2, .criterium.result-3").each(function(){var e;return e=$(this),e.find(".criterium-quicktips").length>0&&!e.find(".criterium-quicktips").is(":empty")?i.push({imp:parseFloat(e.find(".prio-score").text()),id:e.attr("id"),tips:e.find(".criterium-quicktips").text()}):void 0}),$(".prio-score, .criterium-quicktips").remove(),i.sort(function(e,t){return e.imp-t.imp}),i.reverse(),r=0;5>r;)i[r]&&$("#report-priorities ol").append('<a href="#'+i[r].id+'"><li id="quick-win-'+(r+1)+'" quick-wins"><i></i>'+i[r].tips+"</li></a>"),r++;return t=$("#get-manycontact-quick-wins"),a=!$("#criterium-conversion_form").hasClass("result-1"),o=$("#report-priorities ol"),e=o.find(">a[href=#criterium-conversion_form]"),n=0===$("#criterium-technologies").find("span.tech-manycontacts, span.tech-hello_bar").length,t.length>0&&a&&n&&(e.length>0?e.replaceWith(t.html()):(s=Math.floor(5*Math.random()),0===s?o.prepend(t.html()):o.find(">a:nth-child("+s+")").before(t.html()),o.find(">a:last-child").remove())),$("#report-priorities ol a:not(.external-link)").on("click",function(e){return e.preventDefault(),scrollTo($($(this).attr("href")).trigger("click"),500)}),$("#report-priorities").delay(300).slideDown(600)},initTopBarTrial=function(e){var t,n,a;return n=$("#top-bar-trial"),0!==n.length&&(a=$("#top").addClass("has-trial-bar"),t=$("#flying"),setTimeout(function(){return t.addClass("trial-bar-visible"),a.addClass("trial-bar-visible"),n.addClass("visible")},e)),$("#top-bar-register").click(function(){return _gaq.push(["_trackEvent","Report","TopBarRegisterClick",currentWebsite])})},resetSharingBox=function(){var e;return e=$("#sharing-pj-modal").removeClass("loaded"),e.find(".svg-loader, .embed-sharing-c, .link-sharing-c").toggleClass("hidden"),e.find("input#sharing-puburl, input#sharing-size-w, input#sharing-size-h").val(" "),e.find("#sharing-sizes input").off("change"),e.find("button#send-sharing-email").off("click")},getSharingUrl=function(e){var t,n,a;return a=$("#sharing-pj-modal"),a.hasClass("loaded")||(a.addClass("loaded"),n=a.find("link.link-to-load").attr("href"),t="type="+e,"pwd"===e&&(t+="&password="+$("#sharing-pwd").val()),$.ajax({type:"GET",cache:!1,url:n,data:t,dataType:"json",context:a,success:function(e){return a=$(this),e&&e.result?(a.find(".svg-loader, .embed-sharing-c, .link-sharing-c").toggleClass("hidden"),a.find("input#sharing-puburl").val(e.publicUrl),a.find("div#sharing-embed").html(e.embedCode),a.find("input#sharing-size-w").val(e.width),a.find("input#sharing-size-h").val(e.height)):void 0}})),a.find("#sharing-sizes input").on("change",function(){var e,t,n,r,i,o;return n={w:/width="[0-9]*/i,h:/height="[0-9]*/i},t={w:'width="',h:'height="'},o=$(this),i=o.attr("id").replace("sharing-size-",""),r=parseInt(o.val()),e=a.find("div#sharing-embed code").text(),a.find("div#sharing-embed code").text(e.replace(n[i],t[i]+r))}),a.find("#sharing-embed, #sharing-puburl").on("click",function(){return SelectText($(this).attr("id"))}),a.find("#sharing-puburl").on("click",function(){return this.select()})},prettifyNumbersInReview=function(){return $(".pj-criterium .part.text,      #criterium-social_impact .part.progressbar,      table.social-media-compare").prettifyBigNumbers()},prettifyNumbersInAdvReview=function(){return $(".part>.metrics-container,      .part.table>.backlinks td:nth-child(2),      .part.table>.backlinks td:nth-child(3),      .lc .val,      .part.table>.ga-data-table").prettifyBigNumbers()},$.fn.extend({prettifyBigNumbers:function(){var e;return e=/([\D]{1})([\d]{4,})([\D]{1})/g,this.each(function(){var t,n,a;return n=$(this),t=n.html(),a=t.replace(e,function(e,t,n,a){var r,i,o,s,l,c;if("."===t||","===t)return e;for(c="</abbr>"+a,r=t+'<abbr class="big-nbr-container">',o=n.length,s=Math.floor(o/3),l=o%3,i=1;s>=i;)c=i===s&&0===l?n.substr(-3*i,3)+c:"<abbr>"+n.substr(-3*i,3)+"</abbr>"+c,i++;return i--,c=r+n.substr(-3*i-l,l)+c}),n.html(a)})}}),prettifyUrlInReviewLists=function(){return $(".criterium .part .cropable-url").prettifyBigUrls(),$(".criterium .part .underscore-url").prettifyBigUrls()},$.fn.extend({prettifyBigUrls:function(){return this.each(function(){var e,t,n,a,r,i;return r=$(this),e=r.text(),i=e.split("/"),i.length>1?(t=i.pop(),n=i.join("/"),a='<span class="url-middle-crop">'+n+"</span>"+'<span class="url-crop-rest">/'+t+"</span>",r.replaceWith($(a))):void 0})}}),hideAllConfirmationForms=function(){return $(".val-set-form").addClass("hidden")},setDataForCrit=function(e){var t;return t=e.find("form.val-set-form:not(.loading)"),e.find(".js-change-data").on("click",function(e){var t,n,a;return e.preventDefault(),t=$(this),a=t.data("type"),n=null!=a?".val-set-"+a.toLowerCase():".val-set-form",t.closest(".criterium-content").find(".part").addClass("hidden"),t.closest(".directory-container").addClass("hidden"),t.closest(".criterium-content").find(n).removeClass("hidden")}),t.on("submit",function(e){var n,a,r;return e.preventDefault(),t=$(this),r=t.attr("action"),a=t.attr("method"),n="url="+currentWebsite+"&"+t.serialize(),t.addClass("loading"),t.removeClass("error"),t.find(".error-msg").text(""),$.ajax({url:r,type:a,data:n,dataType:"json",context:t,cache:!1,success:function(e){return t=$(this),null!=e.error?(t.removeClass("loading"),t.addClass("error"),t.find(".error-msg").text(e.error)):(t.remove(),e.refresh?(location.reload(!0),t.parent().find(".wait-msg").removeClass("hidden")):void 0)}})})},$.fn.extend({prettyTextOverflow:function(){return this.each(function(e,t){var n,a,r;return n=$(t),a=t.scrollWidth>n.innerWidth(),a?(r=n.text().trim(),n.attr("title",r),n.tooltip()):void 0})}}),formatMomentJs=function(e){var t,n;return n=new Date,t=n.getTimezoneOffset(),null==e&&(e="LLL"),$(".moment").each(function(){var n,a,r;return r=$(this),a=Number(r.text()),n=a?moment(a):moment(r.text(),"YYYY-MM-DD HH:mm:ss").subtract("m",t),r.hasClass("no-hour")&&(e="MMM D"),r.text(n.format(e)).removeClass("moment")}),$(".moment-month").each(function(){var e,t;return t=$(this),e=moment(t.text(),"YYYY-MM-DD"),t.text(e.format("MMMM")).removeClass("moment-month")})},loadMustachesFiles=function(e){var t;return""===window.mustacheMainTemplate?(t=0,$(".mustache-to-load").each(function(){return t++,$.ajax({url:$(this).attr("href"),type:"GET",dataType:"html",context:$(this),cache:!0,error:function(){return _gaq.push(["_trackEvent","Error","mustacheLoadFailed",$(this).attr("href")])},success:function(n){var a;return a=$(this),"template"===a.attr("rel")?(window.mustacheMainTemplate=n,window.mustacheTemplates[a.attr("name")]=n):(Mustache.compilePartial(a.attr("name"),n),window.mustacheTemplates[a.attr("name")]=n),t--,0===t&&"function"==typeof e?e():void 0}})})):"function"==typeof e?e():void 0},mustachePromise=null,templateData={main:"",templates:{}},window.getMustacheFiles=function(){var e;return mustachePromise?mustachePromise:(e=$(".mustache-to-load").map(function(e,t){var n,a,r,i;return i=$(t).attr("href"),r=$(t).attr("rel"),a=$(t).attr("name"),n=new $.Deferred,$.ajax({url:i,type:"GET",dataType:"html",cache:!0}).then(function(e){return templateData.templates[a]=e,"template"===r?templateData.main=e:Mustache.compilePartial(a,e),n.resolve(e)},function(e){return _gaq.push(["_trackEvent","Error","mustacheLoadFailed",i]),n.reject(e)}),n.promise()}),mustachePromise=new $.Deferred,$.when.apply($,e).then(function(){return mustachePromise.resolve(templateData)},function(e){return mustachePromise.reject(e)}),mustachePromise.promise())},fetchLatestChanges=function(){return $.ajax({url:resolveDataUrl("/%lang%/project/data/latestchanges/%url%"),dataType:"json"}).pipe(function(e){return 0>=e.latestChanges.length?(new $.Deferred).reject().promise():e})},initLatestChanges=function(){var e;return e=$("#lc-content"),0===e.length?(new $.Deferred).reject().promise():$.when(fetchLatestChanges(),getMustacheFiles()).then(function(t,n){var a,r;return e.find(".svg-loader").remove(),r=n.templates["project-latestchanges"],a=Mustache.render(r,t),e.find("#lc-inner").html(a),checkWooLatestChanges(e),$(window).trigger("latestChangesLoaded")},function(){var t,n;return t=e.offset().top<window.scrollY,n=e.outerHeight(),e.remove(),t?window.scrollBy(0,-n):void 0})},resolveDataUrl=function(e){return e=e.replace("%url%",currentWebsite),e=e.replace("%lang%",wooLang),"undefined"!=typeof ajaxPjDataProxyUrl&&null!==ajaxPjDataProxyUrl?ajaxPjDataProxyUrl+encodeURIComponent(e):e},window.requestCache={},fetchProviderData=function(e){return requestCache[e]||(requestCache[e]=$.ajax({url:e,type:"GET",dataType:"json",cache:!0}),requestCache[e].fail(function(t,n){return console.error(""+n+" while fetching '"+e+"'")})),requestCache[e]},fetchPjCriteriumData=function(e){var t,n;return t=new $.Deferred,0>=e.length?(t.resolve({parts:[]}),t.promise()):(n=e.map(fetchProviderData),$.when.apply(this,n).then(function(){var e,a;return a=1===n.length?[arguments]:arguments,e=$.map(a,function(e){return e[0]}),t.resolve(e)},t.reject),t.promise())},getCriteriumId=function(e){var t,n;return t=e.attr("id"),n=/^criterium-(.+)$/.exec(t),n?n[1]:void 0},extractDataProviders=function(e){var t;return t=e.attr("src").split(",").map(resolveDataUrl)},renderProject=function(){return initLatestChanges(),$.getJSON(resolveDataUrl("/%lang%/project/data/general/%url%")).then(function(e){return e.young?$("#young-message").show():void 0}),$(".js-action-highlight-inside-review").on("click",function(e){return e.preventDefault(),window.doHighlight("inside-review")}),$(".js-action-gen-inside-review").on("click",function(e){return e.preventDefault(),$("#generate-report-input").attr("value",this.dataset.url),window.doHighlight("inside-review"),$("#generate").click()}),renderProjectCriteria()},initializeAdvice=function(e,t){return t?e.find(".criterium-advice").html(t):e.find(".criterium-advice, .criterium-advice-click").remove()},handleFallback=function(e){var t,n,a,r,i;if(e.length>0){for(i=[],a=0,r=e.length;r>a;a++)n=e[a],t=$("#criterium-"+n),t.hasClass("hidden")?i.push(t.removeClass("hidden")):i.push(void 0);return i}},renderProjectCriteria=function(){var e,t;return t=[],e=[],$(".pj-criterium").each(function(n,a){var r,i,o,s,l;return r=$(a),s=getCriteriumId(r),o=extractDataProviders(r),i=fetchPjCriteriumData(o).pipe(function(t){var n,a,r;return r=[],e=[],n=[],a=[],$.each(t,function(t,i){var o;return e=e.concat(i.missingData||[]),a=a.concat(i.fallbackCriteria||[]),o=i[s],o&&(r=r.concat(o.parts||[]),o.advice&&n.push(o.advice)),"continue"}),{missingData:e,fallbackCriteria:a,parts:$.grep(r,function(e){return e}),advice:n}}),l=$.when(i,getMustacheFiles()).pipe(function(e,t){var n,a,i,o,s,l,c;return c=t.templates.projectParts,o=r.offset().top<window.scrollY,l=r.outerHeight(),handleFallback(e.fallbackCriteria),i=e.advice[0],initializeAdvice(r,i),prettifyNumbersInAdvReview(),0>=e.parts.length?(r.remove(),s=0):c&&(n=r.find(".criterium-content"),r.removeClass("criterium-loading"),r.addClass("result-0"),window.renderProjectParts(n,e,c),s=r.outerHeight(),n.find(".text-overflow").prettyTextOverflow(),formatMomentJs(),isSharedReview&&cleanWooRankLinks()),o&&(a=s-l,window.scrollBy(0,a)),r.find(".simple-tooltip").tooltip(),e},function(){return r.remove()}),t.push(l)}),$.when.apply(this,t)},unique=function(e){return $.grep(e,function(t,n){return n===$.inArray(t,e)})},bindEventOnSettingsBox=function(e,t){return e.find(".tabs-container a.close").on("click",function(n){var a;return n.preventDefault(),a=t.mustache.projectId,setCookie("settings-dismissed-"+a,!0),e.slideUp("200",function(){return e.remove()})}),e.find("form#review-settings-form").on("submit",function(t){var n;return t.preventDefault(),n=$(this),$.ajax({url:saveSettingsInReviewUrl,type:"POST",data:n.serialize(),dataType:"json",context:n,cache:!1,success:function(t){return t.success?location.reload():e.remove()}})}),e.find("a.tab-link").on("click",function(t){var n,a,r;return t.preventDefault(),r=$(this),n=r.attr("href"),a=$(n),a.siblings().removeClass("active"),a.addClass("active"),r.hasClass("btn-next")?e.find(".tabs-container li").removeClass("active").each(function(){return $(this).find(">a.tab-link").attr("href")===n?$(this).addClass("active"):void 0}):(r.parent("li").siblings().removeClass("active"),r.parent("li").addClass("active"))}),e.find("#facebook-page").on("change",function(){var e;return e=$(this),e.val().length>2?($("#auth-fb").removeClass("hidden"),e.off("change")):void 0}),e.find("#keyword-adder #keyword-input").keypress(function(e){var t;return t=$(this),13===e.keyCode?(e.preventDefault(),t.hasClass("acSelect")||($("#keyword-adder button").trigger("click"),t.trigger("focus")),t.removeClass("acSelect")):9===e.keyCode?(e.preventDefault(),t.val(t.val()+",")):void 0}),e.find("#keyword-adder button").on("click",function(e){var t,n,a,r,i,o,s,l,c;for(e.preventDefault(),l=$(this),i=l.prev("div").find("#keyword-input"),c=i.val(),o=$("#keyword-list ul"),s=$("#keyword-list>input"),n=c.split(","),r=""===s.val()?"":";",t=0;n.length>t;){if(a=$.trim(n[t]),""!==a){if(r+=a,o.find(">li").length>29)break;n.length>t+1&&(r+=";"),o.append("<li>"+a+'<span class="keyword-remover"><i class="icon-remove"></i></span></li>')}t++}return s.val(s.val()+r),i.val("").trigger("focusout")}),e.find("#keyword-list ul li .keyword-remover").live("click",function(e){var t,n,a,r;return e.preventDefault(),a=$(this).parent(),r=a.text(),t=$("#keyword-list>input"),n=t.val(),n=n.replace(r+";",""),n=n.replace(";"+r,""),n=n.replace(r,""),t.val(n),a.remove()}),e.find("a.load-in-modal").on("click",function(e){var t,n,a,r,i;return e.preventDefault(),e.stopPropagation(),r=$(this),i=r.attr("href"),a=r.attr("id"),puAppId&&!t&&(n=new Pusher(puAppId),t=n.subscribe("thirdParty_"+$("#project-domain").val())),t.bind(a,function(e){return t.unbind(a),console.log(e),e.gafinal?r.replaceWith('<span class="ga-profile-value"><i class="icon-ok"></i>&nbsp;&nbsp;'+e.gafinal+"</span>"):r.replaceWith('<span class="fb-page-ok"><i class="icon-ok"></i></span>')}),window.open(i,"_blank","height=600,width=900")})},getSettingsDataFor=function(e,t,n){return $.ajax({url:settingsInReviewUrl,type:"GET",data:"msection="+e+"&domain="+currentWebsite,dataType:"json",context:t,cache:!1,success:function(e){var t,a;return a=$(this),e.result&&e.displayBox?(e.result&&(t=Mustache.render(window.mustacheTemplates[n],e.mustache)),a.append(t).slideDown(),bindEventOnSettingsBox(a,e)):a.remove()}})},renderSettingBox=function(e){var t;return t=$("#settings-review-box-container"),$.ajax({url:t.find("#settings-review-box-mustache-tpl").attr("href"),type:"GET",dataType:"html",context:t,cache:!0,success:function(t){var n,a;return a=$(this),n=a.find("#settings-review-box-mustache-tpl").attr("name"),window.mustacheTemplates[n]=t,getSettingsDataFor(e,a,n)}})},$(function(){var e,t;return window.initWooFlyingMenu=function(e){var t,n,a,r;return null==e&&(e=0),n=$("#top"),a=$("#flying"),t=parseInt(n.attr("fake-offset")),r=0,n.length>0&&(r=n.offset().top),isNaN(t)||(r+=t),$(window).off("scroll"),$(window).on("scroll",function(){var e,t;return window.scrollY>$("#left-nav").offset().top?(a.addClass("is-flying"),t=a.find(".inpage-link"),t.length>0&&(e=!1,$(t).each(function(t,n){var a,i;return n=$(n),a=n.attr("href"),i=$(a).offset().top,window.scrollY+70+r>=i?e=n:void 0}),t.removeClass("current"),e)?e.addClass("current"):void 0):a.removeClass("is-flying")}),a.find("a.inpage-link").on("click",function(e){var t,n;return e.preventDefault(),t=$(this).attr("href"),n=isNaN(parseInt(t))?$(t):$(".spied").eq(t),scrollTo(n,500)})},$("form.ajax-generate-report").on("submit",function(e){var t,n,a;return a=$(this),t=!1,a.find("input.required").each(function(){return""===$(this).val()?t=!0:void 0}),a.hasClass("ajax-valid")||t||a.hasClass("waiting-for-ajax")?a.hasClass("ajax-valid")?void 0:(e.preventDefault(),!1):(e.preventDefault(),a.find(".label-default").val(""),n=a.addClass("waiting-for-ajax").serialize(),$.ajax({type:"POST",data:n+"&ajax=1",cache:!1,url:a.attr("action"),context:a,dataType:"json",success:function(e){return"ok"===e.status?a.addClass("ajax-valid").attr("action",e.url).trigger("submit"):"suggest"===e.status?(a.removeClass("waiting-for-ajax").find("#generate-report-input, #generate-report-input-home").val(e.url),a.trigger("submit")):"rr"===e.status||"errorMessage"===e.status?window.location.replace(e.url):a.removeClass("waiting-for-ajax").find("#generate-report-input").addClass("required")}}),!1)}),$("form.ajax-generate-report .gift-token").click(function(){var e;return e=$("<input type='hidden' name='giftToken' />"),e.val("1"),$("form.ajax-generate-report").append(e)}),$("#generate-report .comp-button").on("click",function(e){var t,n,a;return e.preventDefault(),t=$(this),a=t.parents(".gen-inputs"),n=t.parents("form.generate-form"),t.find("i").toggleClass("hidden"),a.toggleClass("open"),n.toggleClass("comp-visible")}),window.usePiecon=!1,window.isInsideReview=$("#dashboard-content").hasClass("inside-page"),window.ispaidReview=$("#dashboard-content").hasClass("paid-review"),window.isAdvancedReview=$("body").hasClass("enrichrev"),window.currentWebsite=$("#dashboard-site>h1>a").data("url"),window.isSharedReview=$("body").hasClass("shared"),isSharedReview&&(window.ajaxPjDataProxyUrl=location.pathname.replace("public","pub-data")+"?u=",cleanWooRankLinks()),isMobile||initWooFlyingMenu(),isInsideReview||initWooCounter(),initDashboardFooter(),t=function(){return competizeAll(),setDataForCrit($("body"))},loadMustachesFiles(t),$("#dashboard").hasClass("generating-report")&&!isMobile?initTopBarTrial(6e3):(checkEmptyModule(),checkWooChart(!1),wooMaps(),isMobile&&($("#report-content").show(),$(".loading_sentence").remove(),clearInterval(loading_sentence_li_i_interval),activeMenuItem()),calculTopPriorities(),calculTopBars(),prettifyNumbersInReview(),prettifyUrlInReviewLists(),isMobile?_gaq.push(["_trackEvent","IpadReport","ReviewDate",$("#dashboard-site .generated-time .value-title").attr("title")]):(_gaq.push(["_trackEvent","Report","ReviewDate",$("#dashboard-site .generated-time .value-title").attr("title")]),initTopBarTrial(3e3))),formatMomentJs(),updateAllWooHighChartsHeight(),$(".fit-text").fitText({mediaQueries:{805:{minSize:12,maxSize:22}}}),$(".criterium").live("click",function(e){var t,n;return $(e.target).closest("a, .no-advice-target").length>0||(e.preventDefault(),n=$(this),n.toggleClass("open-crit").find(".criterium-advice").slideToggle(100),!n.hasClass("open-crit"))?void 0:(t=n.attr("id"),t=t.replace("criterium-",""),_gaq.push(["_trackEvent","Report","OpenAdvice",t]))}),$("#report-priorities .show-more-task a").on("click",function(e){return e.preventDefault(),$("#report-priorities .show-more-task i").toggleClass("hidden"),$(this).off("click")}),$("#dashboard .date-dropdown .dropdown-value").on("change",function(){return _gaq.push(["_trackEvent","Report","changeReviewDate",currentWebsite]),window.location="/"+wooLang+"/review/"+currentWebsite+"/"+$(this).val()}),$("#project-embed").on("click",function(){return getSharingUrl("nopwd")}),$("#sharing-pj-modal .sharing-password-c button").on("click",function(){return resetSharingBox(),getSharingUrl($(this).val())}),$("#pdf-download-direct").on("click",function(){var e;return e=$(this),e.hasClass("dl-disabled")?void 0:$("form#get-pdf button[value=pdf], form#get-pdf button[value=inpdf]").trigger("click")}),$("#slide-download-direct").on("click",function(){var e;return e=$(this),e.hasClass("dl-disabled")?void 0:$("form#get-pdf button[value=slide], form#get-pdf button[value=inslide]").trigger("click")}),$("#short-url pre, #short-url a.copy").on("click",function(){return SelectText("short-val")}),$("body").externalLinks(),$("body").truncate(),$("#short-url a#short-label").on("click",function(e){var t;return e.preventDefault(),t=$(this),t.hasClass("load")?void 0:(t.addClass("load").fadeTo(100,.5),_gaq.push(["_trackEvent","Report","RequestShortUrl",currentWebsite]),$.ajax({type:"POST",data:"url="+currentWebsite,cache:!1,url:shortUrl,dataType:"html",context:$(this).parent("#short-url"),success:function(e){var n;return t=$(this),n=t.find("pre").removeClass("hidden"),t.find("#short-label").remove(),e=$.trim(e),n.html(e.replace("http://","<span>http://</span>")).trigger("click")}}))}),$("#right-panel.light-report").length>0&&($("#right-panel.light-report .module.module-empty").each(function(){var e,t;return t=$(this),e=t.attr("id"),t.removeClass("hidden").removeClass("module-empty").addClass("lightversion").show().append($("#teasing-box ."+e))}),$("body.review .teasing-box").on("click",function(){var e,t;return t=$(this),e=t.attr("class").replace(" teasing-box",""),_gaq.push(["_trackEvent","LightReport","TeasingBoxClick",e]),window.location="/"+wooLang+"/user/plan"}),checkEmptyModule("#right-panel")),isAdvancedReview&&renderProject().then(function(){var e;return e=$.map(arguments,function(e){return e.missingData}),e=unique(e),e.length>0&&!isSharedReview&&renderSettingBox(e),isSharedReview?void 0:(window.projectTaskUrl=$("input#project-tasks-url").val(),loadProjectTasks(projectTaskUrl))}),e=getParameterByName("goto"),e&&""!==e?scrollTo($("#"+e),500):void 0});